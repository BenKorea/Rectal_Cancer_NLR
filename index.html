<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Significance of neutrophil-to-lymphocyte ratio for predicting clinical outcomes in rectal cancer</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


<meta name="citation_title" content="Significance of neutrophil-to-lymphocyte ratio for predicting clinical outcomes in rectal cancer">
<meta name="citation_author" content="R &amp;amp; Python Study Group">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Literate programming;,citation_author=Donald E. Knuth;,citation_publication_date=1984-05;,citation_cover_date=1984-05;,citation_year=1984;,citation_fulltext_html_url=https://doi.org/10.1093/comjnl/27.2.97;,citation_issue=2;,citation_doi=10.1093/comjnl/27.2.97;,citation_issn=0010-4620;,citation_volume=27;,citation_journal_title=Comput. J.;,citation_publisher=Oxford University Press, Inc.;">
</head>

<body>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Significance of neutrophil-to-lymphocyte ratio for predicting clinical outcomes in rectal cancer</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Author</div>
          <div class="quarto-title-meta-heading">Affiliation</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">R &amp; Python Study Group </p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        KIRAMS
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      <div class="quarto-alternate-formats"><div class="quarto-title-meta-heading">Other Formats</div><div class="quarto-title-meta-contents"><p><a href="index.docx"><i class="bi bi-file-word"></i>MS Word</a></p></div><div class="quarto-title-meta-contents"><p><a href="index-meca.zip" data-meca-link="true"><i class="bi bi-archive"></i>MECA Bundle</a></p></div></div></div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#background" id="toc-background" class="nav-link active" data-scroll-target="#background">Background</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#patient-cohort" id="toc-patient-cohort" class="nav-link" data-scroll-target="#patient-cohort">Patient cohort</a></li>
  <li><a href="#definitions" id="toc-definitions" class="nav-link" data-scroll-target="#definitions">Definitions</a></li>
  <li><a href="#follow-up-and-study-endpoints" id="toc-follow-up-and-study-endpoints" class="nav-link" data-scroll-target="#follow-up-and-study-endpoints">Follow-up and study endpoints</a></li>
  <li><a href="#statistical-analysis" id="toc-statistical-analysis" class="nav-link" data-scroll-target="#statistical-analysis">Statistical analysis</a></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#baseline-patient-characteristics-and-inflammatory-related-parameters" id="toc-baseline-patient-characteristics-and-inflammatory-related-parameters" class="nav-link" data-scroll-target="#baseline-patient-characteristics-and-inflammatory-related-parameters">Baseline patient characteristics and inflammatory-related parameters</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="index-preview.html"><i class="bi bi-journal-code"></i>Article Notebook</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">



  


<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<section id="patient-cohort" class="level3">
<h3 class="anchored" data-anchor-id="patient-cohort">Patient cohort</h3>
<p>We retrospectively reviewed <strong>927</strong> RC patients who underwent R0 surgical resection between <strong>1998-01-13</strong> and <strong>2015-06-12</strong> at the <strong>MD Anderson Cancer Center</strong>. Magnetic resonance imaging was used to evaluate the clinical stage of the tumour preoperatively. The final diagnosis of the patients was confirmed by routine pathology. The exclusion criteria were as follows: recurrent or metastatic RC confirmed preoperatively or at surgery, emergency cases, unavailable clinicopathological data, more than 1 primary cancer, receiving anticancer treatments preoperatively, resections with macro- or microscopically positive pathological margins and with active infection or the use systemic corticosteroids. The TNM classification of malignant tumours, 8th edition, edited by the Union for International Cancer Control (UICC) was used to determine the TNM stage. Patients with T1 RCs and no signs of lymph node metastasis on endorectal ultrasound or MRI underwent local excision through transanal endoscopic microsurgery (TEM), or laparoscopic or open surgery was performed. Informed consent was obtained from each patient, and the present study was approved by the Ethics Committee of the <strong>KIRAMS.</strong></p>
</section>
<section id="definitions" class="level3">
<h3 class="anchored" data-anchor-id="definitions">Definitions</h3>
<p>Peripheral blood was obtained 1 week prior to surgery. The NLR was determined by dividing the absolute neutrophil count by the absolute lymphocyte count; the PLR was determined by dividing the absolute platelet count by the absolute lymphocyte count; and the LMR was determined by dividing the absolute lymphocyte count by the absolute monocyte count. The PNI was calculated by the following formula: serum albumin (g/L) + 5 × total lymphocyte count × 109/L. [19] Postoperative complications were defined as any in-hospital or 30-day postoperative complication and graded according to the Clavien- Dindo classification [20].</p>
</section>
<section id="follow-up-and-study-endpoints" class="level3">
<h3 class="anchored" data-anchor-id="follow-up-and-study-endpoints">Follow-up and study endpoints</h3>
<p>Patients were followed-up periodically after surgery. Re-examination was performed at 3-month intervals for the first 2 years postoperatively, every 6months for the next 3 years and every year thereafter. Physical examinations and blood tests, including serum carcinoembryonic antigen (CEA) levels, were performed at each follow-up. A chest X-ray and abdominopelvic computed tomography scan were performed every 6 months, and colonoscopy was performed annually or when there was a suspicion of recurrence. In addition, rigid rectoscopy and endorectal ultrasound were conducted at every visit except for the colonoscopy visit of the TEM patients. The primary endpoints were cancer recurrence or death. The secondary endpoint was the occurrence of postoperative complications. Overall survival (OS) was calculated as the date of diagnosis to the date of death from any cause. Disease-free survival (DFS) was defined as the time interval from cancer diagnosis until tumour recurrence or death from any cause.</p>
</section>
<section id="statistical-analysis" class="level3">
<h3 class="anchored" data-anchor-id="statistical-analysis">Statistical analysis</h3>
<p>The data are presented as the mean ± standard deviation. Categorical variables were analysed with Pearson’s Chisquare test or Fisher’s exact test as appropriate. The cutoff values for NLR, PLR, LMR, and PNI were determined using <strong>maxstat package test function</strong>. Kaplan–Meier analysis and the log rank test were used to compare the survival curves of the 2 groups. Risk factors for poor survival were detected by univariate and multivariate analyses using the Cox proportional hazards model. Variables with a P value of &lt; 0.05 in the univariate analysis were further evaluated in the multivariate analysis to assess the independent predictors for OS and DFS. Statistical analyses were performed using <strong>R version 4.4.0 (2024-04-24 ucrt).</strong> A statistically significant difference was defined as a P value of &lt; 0.05.</p>
</section>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<section id="baseline-patient-characteristics-and-inflammatory-related-parameters" class="level3">
<h3 class="anchored" data-anchor-id="baseline-patient-characteristics-and-inflammatory-related-parameters">Baseline patient characteristics and inflammatory-related parameters</h3>
<p>A total of <strong>927</strong> RC patients were enrolled in this study. The characteristics of the patients are shown in Table 1. Our study group comprised 90 (58.4%) male and 64 (41.6%) female patients, with a mean age of 63.7 years (range 32–90 years). A total of 63 (40.9%) patients had 1 or more comorbidities. TEM was conducted in 47 patients, while laparoscopic (n = 53) or open surgery (n = 54) was performed in 107 patients. No mortality occurred 30 days after the operation. A total of 26 complications (grade I-IVa) occurred in 22 (14.3%) patients postoperatively, including 22 grade I-II and 4 grade III-IVa complications. With a median followup interval of 42.4 months (range 12–89 months), the 3- year OS and DFS rates of all patients were 90.9 and 87.7%, respectively. Three patients died from a cause other than rectal cancer. The distributions of preoperative inflammatory-related parameters are shown in Table 2. The optimal cut-off values for preoperative NLR, PLR, LMR and PNI that best predicted OS were calculated to be 2.8 (area under the curve (AUC): 0.71; sensitivity: 53.0%; specificity: 84.0%), 140.0 (AUC: 0.64; sensitivity: 80.0%; specificity: 58.0%), 3.9 (AUC: 0.68; sensitivity: 73.0%; specificity: 65.0%), and 47.1 (AUC: 0.75; sensitivity: 60.0%; specificity: 83.0%), respectively (Fig. 1a-d). Then, the patients were dichotomized into high or low NLR/PLR/LMR/PNI groups with these cut-off values. The numbers and features of patients in each group are listed in Table 1.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
                Descriptive Statistics by 'RECUR'                
—————————————————————————————————————————————————————————————————— 
                                  No              Yes          p  
                               (N=795)          (N=132)     
—————————————————————————————————————————————————————————————————— 
 Male                                                        0.876
   - Female                  316 (39.7%)       54 (40.9%)         
   - Male                    479 (60.3%)       78 (59.1%)         
 CCTx                                                        0.736
   - 5FU                      2 ( 1.8%)         0 ( 0.0%)         
   - NA                       6 ( 5.4%)         0 ( 0.0%)         
   - XELODA                  104 (92.9%)       8 (100.0%)         
 ASA                                                         0.167
   - 2                        72 ( 9.1%)       9 ( 6.8%)          
   - 3                       266 (33.5%)       34 (25.8%)         
   - 4                        2 ( 0.3%)         0 ( 0.0%)         
   - NA                      455 (57.2%)       89 (67.4%)         
 Induct                                                      0.005
   - FOLFOX                   8 (72.7%)         0 ( 0.0%)         
   - FOLFOX+AVA                0 ( 0.0%)       1 (50.0%)          
   - FOLFOX4                  3 (27.3%)         0 ( 0.0%)         
   - FOLFOXIRI                 0 ( 0.0%)       1 (50.0%)          
 Induction                                                   1.000
   - No                      784 (98.6%)      130 (98.5%)         
   - Yes                      11 ( 1.4%)       2 ( 1.5%)          
 LOC                                                         0.725
   - LR                      303 (38.1%)       51 (38.6%)         
   - MR                      343 (43.1%)       60 (45.5%)         
   - UR                      149 (18.7%)       21 (15.9%)         
 cT                                                          0.449
   - 2                        42 ( 5.3%)       4 ( 3.0%)          
   - 3                       674 (84.8%)      114 (86.4%)         
   - 4                        72 ( 9.1%)       14 (10.6%)         
   - Unknown                  7 ( 0.9%)         0 ( 0.0%)         
 cN                                                          0.966
   - 0                       231 (29.1%)       41 (31.1%)         
   - 1                       470 (59.1%)       75 (56.8%)         
   - 2                        88 (11.1%)       15 (11.4%)         
   - Unknown                  6 ( 0.8%)        1 ( 0.8%)          
 cStage                                                      0.896
   - II                      231 (29.1%)       41 (31.1%)         
   - III                     558 (70.2%)       90 (68.2%)         
   - Unknown                  6 ( 0.8%)        1 ( 0.8%)          
 cStage23                                                    0.896
   - II                      231 (29.1%)       41 (31.1%)         
   - III                     558 (70.2%)       90 (68.2%)         
   - NA                       6 ( 0.8%)        1 ( 0.8%)          
 APPROACH                                                    0.007
   - Laparoscopic             24 ( 3.0%)       2 ( 1.5%)          
   - Open                    671 (84.4%)      125 (94.7%)         
   - Robot                   100 (12.6%)       5 ( 3.8%)          
 MIS                                                         0.003
   - No                      671 (84.4%)      125 (94.7%)         
   - Yes                     124 (15.6%)       7 ( 5.3%)          
 Surgery                                                     0.162
   - aPR                      1 ( 0.1%)         0 ( 0.0%)         
   - APR                     162 (20.4%)       41 (31.1%)         
   - CAA                     219 (27.5%)       38 (28.8%)         
   - Hartmann's excision      4 ( 0.5%)         0 ( 0.0%)         
   - LAR                     361 (45.4%)       47 (35.6%)         
   - PE                       6 ( 0.8%)        2 ( 1.5%)          
   - PPE                      7 ( 0.9%)        1 ( 0.8%)          
   - TPE                      14 ( 1.8%)       2 ( 1.5%)          
   - ULAR                     21 ( 2.6%)       1 ( 0.8%)          
 SSS                                                         0.019
   - No                      191 (24.0%)       45 (34.1%)         
   - Yes                     604 (76.0%)       87 (65.9%)         
 Histology                                                   0.073
   - MD                      675 (84.9%)       98 (74.2%)         
   - MD,MUC                   1 ( 0.1%)         0 ( 0.0%)         
   - MUC                      1 ( 0.1%)        1 ( 0.8%)          
   - NA                       1 ( 0.1%)         0 ( 0.0%)         
   - PD                      103 (13.0%)       28 (21.2%)         
   - SRC                      1 ( 0.1%)         0 ( 0.0%)         
   - SRC,PD                   1 ( 0.1%)         0 ( 0.0%)         
   - WD                       12 ( 1.5%)       5 ( 3.8%)          
 CRM                                                         0.059
   - NA                       15 ( 1.9%)       2 ( 1.5%)          
   - negative                 1 ( 0.1%)         0 ( 0.0%)         
   - Negative                769 (96.7%)      124 (93.9%)         
   - Positive                 10 ( 1.3%)       6 ( 4.5%)          
 DRM                                                         0.116
   - NA                       15 ( 1.9%)       3 ( 2.3%)          
   - Negative                778 (97.9%)      127 (96.2%)         
   - Positive                 2 ( 0.3%)        2 ( 1.5%)          
 R1                                                          0.017
   - 0                       768 (96.6%)      123 (93.2%)         
   - 1                        12 ( 1.5%)       7 ( 5.3%)          
   - NA                       15 ( 1.9%)       2 ( 1.5%)          
 pT                                                          0.000
   - 0                       169 (21.3%)       9 ( 6.8%)          
   - 1                        86 (10.8%)       9 ( 6.8%)          
   - 2                       227 (28.6%)       17 (12.9%)         
   - 3                       285 (35.8%)       84 (63.6%)         
   - 4a                       1 ( 0.1%)        1 ( 0.8%)          
   - 4b                       22 ( 2.8%)       12 ( 9.1%)         
   - 4B                       1 ( 0.1%)         0 ( 0.0%)         
   - is                       4 ( 0.5%)         0 ( 0.0%)         
 pN                                                          0.000
   - 0                       563 (70.8%)       57 (43.2%)         
   - 1                       183 (23.0%)       48 (36.4%)         
   - 1c                       2 ( 0.3%)        1 ( 0.8%)          
   - 2                        47 ( 5.9%)       26 (19.7%)         
 ypStage                                                     0.000
   - 0                       156 (19.6%)       7 ( 5.3%)          
   - 1                       243 (30.6%)       17 (12.9%)         
   - 2                       163 (20.5%)       33 (25.0%)         
   - 3                       233 (29.3%)       75 (56.8%)         
 LVI                                                         0.000
   - 0                       638 (80.3%)       76 (57.6%)         
   - 1                       116 (14.6%)       50 (37.9%)         
   - NA                       41 ( 5.2%)       6 ( 4.5%)          
 PNI                                                         0.000
   - 0                       605 (76.1%)       74 (56.1%)         
   - 1                        99 (12.5%)       39 (29.5%)         
   - NA                       91 (11.4%)       19 (14.4%)         
 LV_PNI                                                      0.000
   - 0                       592 (74.5%)       67 (50.8%)         
   - 1                       163 (20.5%)       60 (45.5%)         
   - NA                       40 ( 5.0%)       5 ( 3.8%)          
 Adj_CTx                                                     0.505
   - 0                        74 ( 9.3%)       14 (10.6%)         
   - 1                       714 (89.8%)      118 (89.4%)         
   - NA                       7 ( 0.9%)         0 ( 0.0%)         
 Adj_KIND                                                    0.926
   - Fluoropyrimidine only   310 (39.0%)       53 (40.2%)         
   - NA                       19 ( 2.4%)       2 ( 1.5%)          
   - None                     73 ( 9.2%)       14 (10.6%)         
   - oxaliplatin combined     1 ( 0.1%)         0 ( 0.0%)         
   - Oxaliplatin combined    392 (49.3%)       63 (47.7%)         
 CTx_regimen               unique values:69 unique values:69      
 DEAD                                                        0.000
   - No                      744 (93.6%)       66 (50.0%)         
   - Yes                      51 ( 6.4%)       66 (50.0%)         
 Recur_site                unique values:40 unique values:40      
 PDFS                        44.9 ± 33.4      18.3 ± 13.4    0.000
 POS                         55.2 ± 39.0      49.9 ± 30.0    0.075
 AGE                                                         0.014
   - 0                        78 ( 9.8%)       23 (17.4%)         
   - 1                       717 (90.2%)      109 (82.6%)         
 RTOP_W                                                      0.887
   - 0                       618 (77.9%)      100 (76.9%)         
   - 1                       175 (22.1%)       30 (23.1%)         
 RT_dose                                                     0.000
   - 0                        99 (13.7%)       34 (27.2%)         
   - 1                       623 (86.3%)       91 (72.8%)         
 AV                                                          0.109
   - 0                       437 (55.0%)       83 (62.9%)         
   - 1                       358 (45.0%)       49 (37.1%)         
 total.LN                                                    0.003
   - 0                       105 (13.2%)       31 (23.7%)         
   - 1                       689 (86.8%)      100 (76.3%)         
 Ptve_LN                                                     0.000
   - 0                       729 (91.8%)       92 (70.2%)         
   - 1                        65 ( 8.2%)       39 (29.8%)         
 RES_G                                                       0.000
   - 0                       399 (50.2%)       24 (18.2%)         
   - 1                       396 (49.8%)      108 (81.8%)         
 Viable                                                      0.012
   - 0                        80 (64.0%)       1 (12.5%)          
   - 1                        45 (36.0%)       7 (87.5%)          
 CEA                                                         0.003
   - 0                       569 (72.4%)       77 (59.2%)         
   - 1                       217 (27.6%)       53 (40.8%)         
 preAlb                                                      0.031
   - 0                       219 (28.6%)       49 (38.6%)         
   - 1                       546 (71.4%)       78 (61.4%)         
 preWBC                                                      0.112
   - 0                       238 (29.9%)       30 (22.7%)         
   - 1                       557 (70.1%)      102 (77.3%)         
 prePLT                                                      0.247
   - 0                       679 (85.4%)      107 (81.1%)         
   - 1                       116 (14.6%)       25 (18.9%)         
 preNEU                                                      0.032
   - 0                        96 (12.1%)       7 ( 5.3%)          
   - 1                       699 (87.9%)      125 (94.7%)         
 preLYM                                                      0.030
   - 0                       120 (15.1%)       10 ( 7.6%)         
   - 1                       675 (84.9%)      122 (92.4%)         
 preNLR                                                      0.236
   - 0                       623 (78.4%)      110 (83.3%)         
   - 1                       172 (21.6%)       22 (16.7%)         
 prePLR                                                      0.289
   - 0                       700 (88.1%)      121 (91.7%)         
   - 1                        95 (11.9%)       11 ( 8.3%)         
 postWBC                                                     0.222
   - 0                       169 (21.3%)       35 (26.5%)         
   - 1                       624 (78.7%)       97 (73.5%)         
 postNEU                                                     0.063
   - 0                       158 (20.4%)       36 (28.1%)         
   - 1                       617 (79.6%)       92 (71.9%)         
 postLYM                                                     0.061
   - 0                       381 (49.6%)       75 (59.1%)         
   - 1                       387 (50.4%)       52 (40.9%)         
 postPLT                                                     0.018
   - 0                       253 (31.9%)       28 (21.2%)         
   - 1                       540 (68.1%)      104 (78.8%)         
 postNLR                                                     0.006
   - 0                       553 (72.3%)       76 (59.8%)         
   - 1                       212 (27.7%)       51 (40.2%)         
 postPLR                                                     0.026
   - 0                       114 (14.9%)       9 ( 7.1%)          
   - 1                       651 (85.1%)      118 (92.9%)         
—————————————————————————————————————————————————————————————————— </code></pre>
</div>
<a class="quarto-notebook-link" id="nblink-1" href="index-preview.html">Source: Article Notebook</a></div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="index_files/figure-html/plot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="index_files/figure-html/plot-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<a class="quarto-notebook-link" id="nblink-2" href="index-preview.html">Source: Article Notebook</a></div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","descPosition":"bottom","loop":false,"closeEffect":"zoom","openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>